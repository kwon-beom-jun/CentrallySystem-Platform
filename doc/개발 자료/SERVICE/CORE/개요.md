# CORE 모듈 개요

<br>

## 📋 개요

CORE 모듈은 프로젝트의 모든 마이크로서비스에서 공통으로 사용되는 기능과 설정을 제공하는 라이브러리 모듈입니다.

<br>

## 🔧 주요 관리 항목

### 1. 공통 엔티티

**역할:** 모든 서비스에서 공통으로 사용되는 JPA 엔티티 베이스 클래스

- **AuditTimeEntity**: 등록일/수정일, 등록자/수정자 자동 관리
- **SoftDeleteEntity**: 논리 삭제 기능 제공
- **AuditEntity**: 현재 미사용 (주석 처리됨)

<br>

### 2. JWT 서비스

**역할:** JWT 토큰 생성, 검증, 파싱 기능 제공

- JWT 토큰 생성 및 검증
- 사용자 정보 추출 (userId, userEmail, username, roles)
- JWT 상수 관리 (`JwtConstants`)

<br>

### 3. Kafka 관리

**역할:** 마이크로서비스 간 이벤트 통신을 위한 Kafka 토픽 및 그룹 관리

#### Kafka 토픽

- **AuthTopics**: 인증 서비스 관련 토픽 (사용자 가입, 권한 변경 등)
- **HrmTopics**: 인사 관리 서비스 관련 토픽 (부서/팀 생성, 변경, 삭제 등)
- **ReceiptTopics**: 영수증 서비스 관련 토픽
- **InfoTopics**: 정보 관리 서비스 관련 토픽

#### Kafka 그룹

- 서비스별 컨슈머 그룹 정의 (AUTH_GROUP, HRM_GROUP, RECEIPT_GROUP, INFO_GROUP)

#### Kafka 이벤트

- **HRM 이벤트**: 부서/팀 생성/변경/삭제, 사용자 조직 변경 등
- **INFO 이벤트**: 게시글 메일 발송 요청 등
- **Auth 이벤트**: 사용자 가입, 권한 변경, 사용자 삭제/활성화 변경 등

<br>

### 4. 유틸리티

**역할:** 공통 유틸리티 함수 제공

- **FileNameUtils**: 파일명 처리 유틸리티
- **ImageProcessor**: 이미지 처리 유틸리티 (썸네일 생성 등)
- **UrlEncodingUtil**: URL 인코딩 유틸리티

<br>

### 5. 예외 처리

**역할:** 전역 예외 처리 핸들러

- **GlobalExceptionHandler**: 공통 예외 처리 (400, 401, 403, 404, 500 등)
- **JsonErrorHandlers**: JSON 형식 에러 응답 핸들러 (401, 403)

<br>

### 6. 필터

**역할:** 공통 필터 기능 제공

- **JwtAuthenticationFilter**: JWT 인증 필터
- **GatewayHeaderAuthFilter**: Gateway 헤더 기반 인증 필터
- **EnabledFilterAspect**: Soft Delete를 위한 Hibernate Filter 활성화 AOP

<br>

### 7. 공통 서비스

**역할:** 여러 서비스에서 공통으로 사용되는 비즈니스 로직

- **EmailService**: 이메일 발송 서비스 (비동기 처리)
- **PagingService**: 페이징 처리 서비스
- **JwtService**: JWT 토큰 관리 서비스

<br>

### 8. 설정 (Config)

**역할:** 공통 설정 및 자동 구성

- **AsyncConfig**: 비동기 작업 설정 (이메일 발송 등)
- **AuditorAwareImpl**: JPA Auditing을 위한 생성자/수정자 자동 설정

<br>

### 9. VO (Value Object)

**역할:** 공통 데이터 전송 객체

- **이벤트 VO**: Kafka 이벤트용 VO (AuthPermissionEvent, AuthUserJoinedEvent 등)
- **페이지 VO**: 페이징 요청/응답 VO (PageRequestVo, PageResponseVo)

<br>

### 10. 도메인 및 Enum

**역할:** 공통 도메인 모델 및 열거형

- **ProcessingStatus**: Kafka Saga/Outbox 프로세스 상태 (PENDING, ACTIVE, FAILED)
- **Role**: 역할 Enum (현재 사용 여부 확인 필요)

<br>

### 11. 보안 (Security)

**역할:** Spring Security 관련 공통 구성

- **CustomUserPrincipal**: 사용자 인증 정보 커스텀 Principal

<br>

## 📌 사용 목적

- **코드 재사용성**: 공통 기능을 한 곳에서 관리하여 코드 중복 제거
- **일관성 유지**: 모든 서비스에서 동일한 방식으로 JWT, Kafka, 예외 처리 등 사용
- **유지보수성**: 공통 기능 수정 시 모든 서비스에 자동 반영
- **표준화**: 프로젝트 전반의 개발 표준 및 패턴 제공

<br>

## 🔗 의존성 관계

모든 마이크로서비스 (Auth, HRM, Receipt, Info, Gateway)가 CORE 모듈을 의존성으로 포함하여 공통 기능을 사용합니다.

<br><br>
